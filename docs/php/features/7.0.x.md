# PHP 7.0.x

## 1. 新特性

### 标量类型声明

标量 [类型声明](http://php.net/manual/zh/functions.arguments.php#functions.arguments.type-declaration) 有两种模式: 强制 (默认) 和 严格模式。 现在可以使用下列类型参数（无论用强制模式还是严格模式）： 字符串([string](http://php.net/manual/zh/language.types.string.php)), 整数 (int), 浮点数 ([float](http://php.net/manual/zh/language.types.float.php)), 以及布尔值 (bool)。它们扩充了PHP5中引入的其他类型：类名，接口，数组和 回调类型。

```php
<?php
// Coercive mode
function sumOfInts(int ...$ints)
{
    return array_sum($ints);
}

var_dump(sumOfInts(2, '3', 4.1));
```

以上例程会输出：

```
int(9)
```

要使用严格模式，一个 [declare](http://php.net/manual/zh/control-structures.declare.php) 声明指令必须放在文件的顶部。这意味着严格声明标量是基于文件可配的。 这个指令不仅影响参数的类型声明，也影响到函数的返回值声明（参见 [返回值类型声明](http://php.net/manual/zh/functions.returning-values.php#functions.returning-values.type-declaration), 内置的PHP函数以及扩展中加载的PHP函数）

完整的标量类型声明文档和示例参见[类型声明](http://php.net/manual/zh/functions.arguments.php#functions.arguments.type-declaration)章节。

### 返回值类型声明

PHP 7 增加了对[返回类型声明](http://php.net/manual/zh/functions.returning-values.php#functions.returning-values.type-declaration)的支持。 类似于[参数类型声明](http://php.net/manual/zh/functions.arguments.php#functions.arguments.type-declaration)，返回类型声明指明了函数返回值的类型。可用的[类型](http://php.net/manual/zh/functions.arguments.php#functions.arguments.type-declaration.types)与参数声明中可用的类型相同。

```php
<?php

function arraysSum(array ...$arrays): array
{
    return array_map(function(array $array): int {
        return array_sum($array);
    }, $arrays);
}

print_r(arraysSum([1,2,3], [4,5,6], [7,8,9]));
```

以上例程会输出：

```
Array
(
    [0] => 6
    [1] => 15
    [2] => 24
)
```

完整的标量类型声明文档和示例可参见 [返回值类型声明](http://php.net/manual/zh/functions.returning-values.php#functions.returning-values.type-declaration).

### null合并运算符

由于日常使用中存在大量同时使用三元表达式和 [isset()](http://php.net/manual/zh/function.isset.php) 的情况， 我们添加了 `null` 合并运算符 (`??`) 这个语法糖。如果变量存在且值不为 `NULL`， 它就会返回自身的值，否则返回它的第二个操作数。

```php
<?php
// Fetches the value of $_GET['user'] and returns 'nobody'
// if it does not exist.
$username = $_GET['user'] ?? 'nobody';
// This is equivalent to:
$username = isset($_GET['user']) ? $_GET['user'] : 'nobody';

// Coalesces can be chained: this will return the first
// defined value out of $_GET['user'], $_POST['user'], and
// 'nobody'.
$username = $_GET['user'] ?? $_POST['user'] ?? 'nobody';
?>
```

### 太空船操作符（组合比较符）

太空船操作符用于比较两个表达式。当 `$a` 小于、等于或大于 `$b` 时它分别返回-1、0或1。 比较的原则是沿用 PHP 的[常规比较规则](http://php.net/manual/zh/types.comparisons.php)进行的。

```php
<?php
// 整数
echo 1 <=> 1; // 0
echo 1 <=> 2; // -1
echo 2 <=> 1; // 1

// 浮点数
echo 1.5 <=> 1.5; // 0
echo 1.5 <=> 2.5; // -1
echo 2.5 <=> 1.5; // 1
 
// 字符串
echo "a" <=> "a"; // 0
echo "a" <=> "b"; // -1
echo "b" <=> "a"; // 1
?>
```

### 通过 [define()](http://php.net/manual/zh/function.define.php) 定义常量数组

[Array](http://php.net/manual/zh/language.types.array.php) 类型的常量现在可以通过 [define()](http://php.net/manual/zh/function.define.php) 来定义。在 PHP5.6 中仅能通过 [const](http://php.net/manual/zh/language.constants.syntax.php) 定义。

```php
<?php
define('ANIMALS', [
    'dog',
    'cat',
    'bird'
]);

echo ANIMALS[1]; // 输出 "cat"
?>
```